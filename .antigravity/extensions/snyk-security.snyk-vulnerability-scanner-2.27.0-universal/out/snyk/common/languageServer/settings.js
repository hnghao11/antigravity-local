"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.LanguageServerSettings = void 0;
const lodash_1 = __importDefault(require("lodash"));
const integration_1 = require("../../cli/contants/integration");
const configuration_1 = require("../configuration/configuration");
const languageServer_1 = require("../constants/languageServer");
const languageServer_2 = require("./languageServer");
class LanguageServerSettings {
    static async fromConfiguration(configuration, user) {
        const featuresConfiguration = configuration.getFeaturesConfiguration();
        const ossEnabled = lodash_1.default.isUndefined(featuresConfiguration === null || featuresConfiguration === void 0 ? void 0 : featuresConfiguration.ossEnabled)
            ? 'true'
            : `${featuresConfiguration === null || featuresConfiguration === void 0 ? void 0 : featuresConfiguration.ossEnabled}`;
        const iacEnabled = lodash_1.default.isUndefined(featuresConfiguration === null || featuresConfiguration === void 0 ? void 0 : featuresConfiguration.iacEnabled)
            ? 'true'
            : `${featuresConfiguration === null || featuresConfiguration === void 0 ? void 0 : featuresConfiguration.iacEnabled}`;
        const codeSecurityEnabled = lodash_1.default.isUndefined(featuresConfiguration === null || featuresConfiguration === void 0 ? void 0 : featuresConfiguration.codeSecurityEnabled)
            ? 'true'
            : `${featuresConfiguration === null || featuresConfiguration === void 0 ? void 0 : featuresConfiguration.codeSecurityEnabled}`;
        return {
            activateSnykCodeSecurity: codeSecurityEnabled,
            activateSnykOpenSource: ossEnabled,
            activateSnykIac: iacEnabled,
            enableDeltaFindings: `${configuration.getDeltaFindingsEnabled()}`,
            sendErrorReports: `${configuration.shouldReportErrors}`,
            cliPath: await configuration.getCliPath(),
            endpoint: configuration.snykApiEndpoint,
            organization: configuration.organization,
            token: await configuration.getToken(),
            automaticAuthentication: 'false',
            authenticationMethod: configuration.getAuthenticationMethod(),
            additionalParams: configuration.getAdditionalCliParameters(),
            manageBinariesAutomatically: `${configuration.isAutomaticDependencyManagementEnabled()}`,
            filterSeverity: configuration.severityFilter,
            issueViewOptions: configuration.issueViewOptions,
            scanningMode: configuration.scanningMode,
            insecure: `${configuration.getInsecure()}`,
            enableTrustedFoldersFeature: 'true',
            trustedFolders: configuration.getTrustedFolders(),
            integrationName: integration_1.CLI_INTEGRATION_NAME,
            integrationVersion: await configuration_1.Configuration.getVersion(),
            deviceId: user.anonymousId,
            requiredProtocolVersion: `${languageServer_1.PROTOCOL_VERSION}`,
            folderConfigs: languageServer_2.LanguageServer.ReceivedFolderConfigsFromLs ? configuration.getFolderConfigs() : [],
            enableSnykOSSQuickFixCodeActions: `${configuration.getOssQuickFixCodeActionsEnabled()}`,
            hoverVerbosity: 1,
        };
    }
}
exports.LanguageServerSettings = LanguageServerSettings;
//# sourceMappingURL=settings.js.map