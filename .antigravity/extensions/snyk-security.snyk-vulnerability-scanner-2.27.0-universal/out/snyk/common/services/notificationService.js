"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NotificationService = void 0;
const snykMessages_1 = require("../../base/messages/snykMessages");
const commands_1 = require("../constants/commands");
const errorHandler_1 = require("../error/errorHandler");
const errors_1 = require("../messages/errors");
class NotificationService {
    constructor(window, commands, configuration, logger) {
        this.window = window;
        this.commands = commands;
        this.configuration = configuration;
        this.logger = logger;
    }
    async init() {
        await this.checkWelcomeNotification().catch(err => errorHandler_1.ErrorHandler.handle(err, this.logger, errors_1.errorsLogs.welcomeNotification));
    }
    async checkWelcomeNotification() {
        if (!this.configuration.shouldShowWelcomeNotification) {
            return;
        }
        const pressedButton = await this.window.showInformationMessage(snykMessages_1.snykMessages.welcome.msg, snykMessages_1.snykMessages.welcome.button);
        if (pressedButton === snykMessages_1.snykMessages.welcome.button) {
            await this.commands.executeCommand(commands_1.VSCODE_VIEW_CONTAINER_COMMAND);
        }
        await this.configuration.hideWelcomeNotification();
    }
    async showErrorNotification(message) {
        await this.showErrorNotificationWithLinkAction(message, 'Show Documentation', 'https://docs.snyk.io/scm-ide-and-ci-cd-integrations/snyk-ide-plugins-and-extensions/visual-studio-code-extension/troubleshooting-for-visual-studio-code-extension');
    }
    async showErrorNotificationWithLinkAction(message, actionText, actionLink) {
        await this.window.showErrorMessage(message, actionText).then(async (selectedAction) => {
            if (selectedAction == actionText) {
                await this.commands.executeCommand(commands_1.SNYK_OPEN_BROWSER_COMMAND, actionLink);
            }
        }, err => errorHandler_1.ErrorHandler.handle(err, this.logger, 'error occurred during error handling'));
    }
}
exports.NotificationService = NotificationService;
//# sourceMappingURL=notificationService.js.map